var MyQuery={addHandler:function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,n)},removeHandler:function(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent("on"+t,n)},addLoadHandler:function(e){this.addHandler(window,"load",e)},hasClass:function(e,t){return e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))},addClass:function(e,t){if(e.className){var n=e.className;n+=" "+t,e.className=n}else e.className=t},removeClass:function(e,t){if(MyQuery.hasClass(e,t)){var n=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(n," ")}},getTagList:function(e,t){if(!t)return e.children;for(var n=e.children,a=[],r=0,o=n.length;o>r;r++)n[r].tagName.toLowerCase()==t.toLowerCase()&&a.push(n[r]);return a},getObjStyle:function(e,t){return e.currentStyle?e.currentStyle[t]:window.getComputedStyle?window.getComputedStyle(e,null)[t]:null},getClassName:function(e){for(var t=[],n=document.getElementsByTagName("*"),a=0;a<n.length;a++)MyQuery.hasClass(n[a],e)&&(t[t.length]=n[a]);return t},setStyle:function(e,t,n){var a,r="";for(a in t)r+=a+":"+t[a]+";";e.style.cssText+=";"+r,n&&"function"==typeof n&&n()},insertAfter:function(e,t){var n=t.parentNode;n.lastChild==t?n.appendChild(e):n.insertBefore(e,t.nextSibling)},styleElementSiblings:function(e,t){if(!document.getElementsByTagName)return!1;for(var n,a=document.getElementsByTagName(e),r=0;r<a.length;r++)n=getNextElement(n[r].nextSibling),MyQuery.addClass(n,t)},rand:function(e,t){return Math.round(e+Math.random()*(t-e))},fade:function(e,t,n,a){"string"==typeof e&&(e=document.querySelector("#"+e)),e.effect||(e.effect={},e.effect.fade=0),clearInterval(e.effect.fade);var n=n||1,r=function(e){var t;return t=-1!=navigator.userAgent.toLowerCase().indexOf("msie")?e.currentStyle.filter.indexOf("opacity=")>=0?parseFloat(e.currentStyle.filter.match(/opacity=([^)]*)/)[1])+"":"100":100*e.ownerDocument.defaultView.getComputedStyle(e,null).opacity}(e);e.effect.fade=setInterval(function(){r=t>r?Math.min(r+n,t):Math.max(r-n,t),e.style.opacity=r/100,e.style.filter="alpha(opacity="+r+")",Math.round(r)==t&&(e.style.opacity=t/100,e.style.filter="alpha(opacity="+t+")",clearInterval(e.effect.fade),a&&a.call(e))},20)},move:function(e,t,n,a){"string"==typeof e&&(e=document.querySelector("#"+e)),e.effect||(e.effct={},e.effect.move=0),clearInterval(e.effect.move);var n=n||10,r=function(e){for(var t={left:e.offsetLeft,top:e.offsetTop};e=e.offsetLeft;)t.left+=e.offsetLeft,t.top+=e.offsetTop;return t}(e);e.style.position="absolute";var o=e.style,i=[];"number"==typeof t.left&&i.push("left"),"number"==typeof t.top&&i.push("top"),e.effect.move=setInterval(function(){for(var l=0;l<i.length;l++)r[i[l]]+=(t[i[l]]-r[i[l]])*n/100,o[i[l]]=r[i[l]]+"px";for(var l=0;l<i.length&&Math.round(r[i[l]])==t[i[l]];l++)if(l==i.length-1){for(var l=0;l<i.length;l++)o[i[l]]=t[i[l]]+"px";clearInterval(e.effect.move),a&&a.call(e)}},20)},resize:function(e,t,n,a){"string"==typeof e&&(e=document.getElementById(e)),e.effect||(e.effect={},e.effect.resize=0),clearInterval(e.effect.resize);var n=n||10,r={width:e.offsetWidth,height:e.offsetHeight},o=[];if(-1==navigator.userAgent.toLowerCase().indexOf("msie")||"BackCompat"!=document.compatMode){var i=document.defaultView?document.defaultView.getComputedStyle(e,null):e.currentStyle;"number"==typeof t.width&&(o.push("width"),t.width=t.width-i.paddingLeft.replace(/\D/g,"")-i.paddingRight.replace(/\D/g,"")),"number"==typeof t.height&&(o.push("height"),t.height=t.height-i.paddingTop.replace(/\D/g,"")-i.paddingBottom.replace(/\D/g,""))}e.style.overflow="hidden";var l=e.style;e.effect.resize=setInterval(function(){for(var i=0;i<o.length;i++)r[o[i]]+=(t[o[i]]-r[o[i]])*n/100,l[o[i]]=r[o[i]]+"px";for(var i=0;i<o.length&&Math.round(r[o[i]])==t[o[i]];i++)if(i==o.length-1){for(var i=0;i<o.length;i++)l[o[i]]=t[o[i]]+"px";clearInterval(e.effect.resize),a&&a.call(e)}},20)},createXMLHTTPRequest:function(){var e;if(window.XMLHttpRequest)e=new XMLHttpRequest;else if(window.ActiveXObject)for(var t=["MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<t.length;n++)try{if(e=new ActiveXObject(t[n]))break}catch(a){console.log(a)}return e},get:function(e,t){var n=MyQuery.createXMLHTTPRequest();n&&(n.open("GET",e,!0),n.onreadystatechange=function(){4==n.readyState&&(200==n.status?t&&"function"==typeof t&&t():alert("error"))},n.send(null))},post:function(e,t,n){var a=MyQuery.createXMLHTTPRequest();a&&(a.open("POST",e,!0),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n&&"string"==typeof n?a.send(n):a.send(null),a.onreadystatechange=function(){4==a.readyState&&(200==a.status?t&&"function"==typeof t&&t(a):alert("error"))})}};!function(e,t){function n(){var t=o.getBoundingClientRect().width;t/d>540&&(t=540*d);var n=t/10;o.style.fontSize=n+"px",c.rem=e.rem=n}var a,r=e.document,o=r.documentElement,i=r.querySelector('meta[name="viewport"]'),l=r.querySelector('meta[name="flexible"]'),d=0,s=0,c=t.flexible||(t.flexible={});if(i){console.warn("将根据已有的meta标签来设置缩放比例");var f=i.getAttribute("content").match(/initial\-scale=([\d\.]+)/);f&&(s=parseFloat(f[1]),d=parseInt(1/s))}else if(l){var u=l.getAttribute("content");if(u){var p=u.match(/initial\-dpr=([\d\.]+)/),m=u.match(/maximum\-dpr=([\d\.]+)/);p&&(d=parseFloat(p[1]),s=parseFloat((1/d).toFixed(2))),m&&(d=parseFloat(m[1]),s=parseFloat((1/d).toFixed(2)))}}if(!d&&!s){var y=(e.navigator.appVersion.match(/android/gi),e.navigator.appVersion.match(/iphone/gi)),h=e.devicePixelRatio;d=y?h>=3&&(!d||d>=3)?3:h>=2&&(!d||d>=2)?2:1:1,s=1/d}if(o.setAttribute("data-dpr",d),!i)if(i=r.createElement("meta"),i.setAttribute("name","viewport"),i.setAttribute("content","initial-scale="+s+", maximum-scale="+s+", minimum-scale="+s+", user-scalable=no"),o.firstElementChild)o.firstElementChild.appendChild(i);else{var v=r.createElement("div");v.appendChild(i),r.write(v.innerHTML)}e.addEventListener("resize",function(){clearTimeout(a),a=setTimeout(n,300)},!1),e.addEventListener("pageshow",function(e){e.persisted&&(clearTimeout(a),a=setTimeout(n,300))},!1),"complete"===r.readyState?r.body.style.fontSize=12*d+"px":r.addEventListener("DOMContentLoaded",function(e){r.body.style.fontSize=12*d+"px"},!1),n(),c.dpr=e.dpr=d,c.refreshRem=n,c.rem2px=function(e){var t=parseFloat(e)*this.rem;return"string"==typeof e&&e.match(/rem$/)&&(t+="px"),t},c.px2rem=function(e){var t=parseFloat(e)/this.rem;return"string"==typeof e&&e.match(/px$/)&&(t+="rem"),t}}(window,window.lib||(window.lib={})),function(){function e(e){var t=document.querySelector("footer");0==e.length&&d===!0&&(d=!1,r.style.display="block",setTimeout(function(){MyQuery.fade(r,0,50)},2e3));for(var a in e){var o=document.createElement("section"),i=document.createElement("div"),l=document.createElement("img"),s=document.createElement("div"),c=document.createElement("div"),f=document.createElement("h2"),u=document.createElement("h3"),p=document.createElement("div"),m=document.createElement("span"),y=document.createElement("div"),h=document.createElement("span"),v=document.createElement("div"),g=document.createElement("p"),C=document.createElement("big"),M=document.createElement("ul");MyQuery.addClass(o,"list-wrap"),MyQuery.addClass(i,"list"),MyQuery.addClass(p,"star"),MyQuery.addClass(l,"list-img"),l.src=e[a].imgUrl,MyQuery.addClass(s,"list-info"),MyQuery.addClass(s,"claerfix"),MyQuery.addClass(c,"info-left"),f.innerHTML=e[a].title;var E=e[a].stars,w=parseInt(E.split("."[0]));if("0"==E)for(var T=0;5>T;T++){var L=document.createElement("i");L.innerHTML="&#xe602;",MyQuery.addClass(L,"iconfont"),p.appendChild(L)}else if("5"==E)for(var T=0;5>T;T++){var L=document.createElement("i");L.innerHTML="&#xe600;",MyQuery.addClass(L,"iconfont"),p.appendChild(L)}else{for(var T=0;w>T;T++){var L=document.createElement("i");L.innerHTML="&#xe600;",MyQuery.addClass(L,"iconfont"),p.appendChild(L)}var x=document.createElement("i");x.innerHTML="&#xe601",MyQuery.addClass(x,"iconfont"),p.appendChild(x);for(var T=0;5-w-1>T;T++){var L=document.createElement("i");L.innerHTML="&#xe602;",MyQuery.addClass(L,"iconfont"),p.appendChild(L)}}if(m.innerHTML="人均"+e[a].average+"元",MyQuery.addClass(y,"info-left-bottom"),h.innerHTML=e[a].distance,MyQuery.addClass(v,"info-right"),C.innerHTML=e[a].discount,g.innerHTML="折",g.insertBefore(C,g.childNodes[0]),v.appendChild(g),e[a].flag){var b=e[a].flag.split("|");for(var a in b){var S=document.createElement("li"),H=document.createElement("img");H.src="src/images/"+b[a]+".png",S.appendChild(H),M.appendChild(S)}}if(u.appendChild(p),u.appendChild(m),0==e[a].good){var Q=document.createElement("span");MyQuery.addClass(Q,"others"),Q.innerHTML=e[a].people+"已享",y.appendChild(Q)}else{var N=document.createElement("img"),q=document.createElement("span");MyQuery.addClass(N,"good"),MyQuery.addClass(q,"freinds"),N.src="src/images/good.png",q.innerHTML=e[a].good+"位朋友",y.appendChild(N),y.appendChild(q)}y.appendChild(h),c.appendChild(f),c.appendChild(u),c.appendChild(y),s.appendChild(c),s.appendChild(v),s.appendChild(M),i.appendChild(l),i.appendChild(s),o.appendChild(i),n.insertBefore(o,t)}}function t(){l&&(l=!1,MyQuery.post(url,function(t){var n=JSON.parse(t.response);e(n.data),o+=i,s="start="+o+"&len="+i,a.style.display="none",l=!0},s))}var n=document.querySelector("body"),a=document.querySelector("footer"),r=document.querySelector("#panel");url="http://kaohe.zeroling.com/kaohe/list";var o=0,i=3,l=!0,d=!0,s="start="+o+"&len="+i;t(),window.onscroll=function(){var e=document.body.offsetHeight,n=document.body.scrollTop,r=document.documentElement.clientHeight;n/(e-r)>=.95&&d&&(a.style.display="block",t())}}();